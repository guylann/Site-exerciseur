<head>
    <link rel="stylesheet" type="text/css" href="base.css">
    <script src="script.js"></script>
    <script>
        var values;
        var typefigure = 0;



        function testReponse() {
            document.getElementById("TextReponse").innerHTML = "";
            var test = document.getElementById("reponseUser").value;
            var flo = parseFloat(test);
            if (flo == values.y)
            {
                document.getElementById("Resultat").innerHTML = "Bravo c'est la bonne réponse";
            }
            else {
                document.getElementById("Resultat").innerHTML = "C'est loupé pour cette fois, la bonne réponse était : ";
                document.getElementById("TextReponse").innerHTML = values.y;
            }

        }

        function recommencer(){
            var param = {minx: -5 ,maxx: 5 ,pasx: 1 ,miny: -5 ,maxy: 5, pasy: 1 ,
                         subx: true ,subx_nbr: 5 ,suby: true ,suby_nbr: 5 ,
                         orthonorme: true}
            
            var canvas = document.getElementById("myCanvas");
            InitFigure(canvas)  
            CreateRepere(canvas, param);

            RandomiseFunction(param, Randint(0,3), 1);

            var a = 1;
            var b = 1;
            var c = 1;
            while (a == 1 && b == 1 && c == 1)
            {
                a = Randint(0,1);
                b = Randint(0,1);
                c = Randint(0,1);
            }

            if (a == 0)
                CreateFunction(canvas, param);
            if (b == 0)
                CreateFormule();
            if (c == 0)
                CreateTableau();

            values = GetsValues();
            

            document.getElementById("valeurx").innerHTML = values.x;
        }

        function premierlancement(){
            recommencer(); 
        }

        function InitFigure(c){
            var ctx = c.getContext("2d");
            ctx.setTransform(1, 0, 0, 1, 0, 0);
            ctx.translate(0.5, 0.5);
            ctx.clearRect(0, 0, c.width, c.height);

            
            document.getElementById("formule").innerHTML = "";
            document.getElementById("Tableau").innerHTML = "";
            document.getElementById("formulestart").style.display = "none";
            document.getElementById("Resultat").innerHTML = "";
            document.getElementById("TextReponse").innerHTML = "";
        }

        function CreateFormule(){
            document.getElementById("formulestart").style.display = "inline-block";
            var parent = document.getElementById("formule");
            parent.innerHTML = '';
            var before = false;
            for(var i = 0; i<coefs.length; ++i) {
                var coef = coefs[coefs.length - 1 - i];
                var puissance = coefs.length - 1 - i;

                if (coef == -1){
                    var a = document.createElement("label");
                    a.innerHTML = " - ";
                    parent.appendChild(a);
                    before = true;
                }
                else if (coef == 0)
                {
                    continue;
                }
                else if (coef != 1)
                {
                    var s = document.createElement("label");
                    if (coef > 0 && before)
                        s.innerHTML = " + ";
                    else
                        s.innerHTML = " - ";
                    parent.appendChild(s);

                    const rational = find_rational( coef, 10000 );
                    if (rational.denominator != 1)
                    {
                        var a = document.createElement("div");
                        a.setAttribute("class", "frac");
                        var b = document.createElement("span");
                        b.innerHTML = Math.abs(rational.numerator);
                        a.appendChild(b);
                        var c = document.createElement("span");
                        c.setAttribute("class", "symbol");
                        c.innerHTML = "/";
                        a.appendChild(c);
                        var d = document.createElement("span");
                        d.setAttribute("class", "bottom");
                        d.innerHTML = rational.denominator;
                        a.appendChild(d);
                        parent.appendChild(a);
                    }
                    else{
                        var a = document.createElement("label");
                        a.innerHTML = Math.abs(rational.numerator);
                        parent.appendChild(a);
                    }
                    before = true;
                }

                if (puissance > 1)
                {
                    var x = document.createElement("label");
                    x.innerHTML = "x<sup>" + puissance + "</sup>";
                    parent.appendChild(x);
                    before = true;
                }
                else if (puissance == 1)
                {
                    var x = document.createElement("label");
                    x.innerHTML = "x";
                    parent.appendChild(x);
                    before = true;
                }
                else if (coef == 1)
                {
                    var x = document.createElement("label");
                    x.innerHTML = " + 1";
                    parent.appendChild(x);
                    before = true;
                }
                else if (coef == -1)
                {
                    var x = document.createElement("label");
                    x.innerHTML = "1";
                    parent.appendChild(x);
                    before = true;
                }


            }
        }

        function CreateTableau(){
            var parent = document.getElementById("Tableau");
            parent.innerHTML = '';
            
            var ligne1 = document.createElement("tr");
            var ligne2 = document.createElement("tr");

            var a = document.createElement("td");
            var l = document.createElement("label");
            l.innerHTML = "x";
            a.appendChild(l);
            ligne1.appendChild(a);

            a = document.createElement("td");
            l = document.createElement("label");
            l.innerHTML = "f(x)";
            a.appendChild(l);
            ligne2.appendChild(a);

            for(k = 0; k < points.length; k++){
                a = document.createElement("td");
                l = document.createElement("label");
                l.innerHTML = points[k].x;
                a.appendChild(l);
                ligne1.appendChild(a);
                
                a = document.createElement("td");
                l = document.createElement("label");
                l.innerHTML = points[k].y;
                a.appendChild(l);
                ligne2.appendChild(a);
            }


            parent.appendChild(ligne1);
            parent.appendChild(ligne2);
        }


    </script>
</head>
<body onload="premierlancement();">
    <div style="height: 50px;"></div>
    <h1><b><u>
        Déterminer l'image d'un nombre.
    </h1></b></u>
    <p>
        Consigne : Donner l'image de la valeur indiquée en vous aidant des informations founies (graphique, expression littérale ou tableau de valeurs).
    </p>
    <table>
        <tr >
            <td rowspan="2" style="border-style: none;">
                <canvas id="myCanvas" width="500" height="500" style="color: white;stroke: white;">
                    Your browser does not support the HTML5 canvas tag.
                </canvas>
            </td>
            <td style="border-style: none;">
                <label id="formulestart">
                    f(x) = 
                </label>
                <div id="formule">
                    <div class="frac">
                        <span>1</span>
                        <span class="symbol">/</span>
                        <span class="bottom">2</span>
                    </div>
                    x<sup>3</sup>
                </div>
            </td>
        </tr>
        <tr>
            <td style="border-style: none;">
                <table style=" border-collapse: collapse;">
                    <tbody id="Tableau" >
        
                    </tbody>
                </table>
            </td>
        </tr>
    </table>
    <p>
    <div>
        <label>
            L'image de 
        </label>
        <label id="valeurx"></label>
        <label>
            par la fonction f est 
        </label>
        <input class="backbutton" type="text" id="reponseUser">
        <input class="backbutton" type="button" value="Valider" onclick="testReponse()"><br>
        <label id="Resultat"></label>
        <label id="TextReponse"></label><br>
    </div>
    </p>
    <p>
        <input class="backbutton" type="button" value="Recommencer ?" onclick="recommencer()">
        <input class="backbutton" type="button" value="Retour" onclick="history.go(-1)">
    </p>
</body>